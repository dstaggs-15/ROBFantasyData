<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fantasy League – Projected Standings & Playoffs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top left, #0f172a 0, #020617 45%, #000 100%);
            color: #e5e7eb;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 32px 16px 40px;
        }

        .page { width: 100%; max-width: 1200px; }

        header {
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            gap: 16px;
            align-items: center;
        }

        header h1 { font-size: 1.9rem; letter-spacing: 0.03em; }

        header .subtitle { font-size: 0.95rem; color: #9ca3af; margin-top: 4px; }

        .badge {
            font-size: 0.85rem;
            padding: 6px 14px;
            border-radius: 999px;
            background: linear-gradient(135deg, #22c55e, #38bdf8);
            color: #0f172a;
            font-weight: 600;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .grid {
            display: grid;
            grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
            gap: 20px;
        }

        .card {
            background: linear-gradient(145deg, rgba(15,23,42,0.98), rgba(15,23,42,0.85));
            border-radius: 18px;
            border: 1px solid rgba(148,163,184,0.25);
            box-shadow: 0 18px 40px rgba(15,23,42,0.7);
            padding: 18px 20px 18px;
            backdrop-filter: blur(14px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 10px;
        }

        .card-header h2 { font-size: 1.15rem; letter-spacing: 0.06em; text-transform: uppercase; }

        .pill {
            font-size: 0.75rem;
            padding: 3px 9px;
            border-radius: 999px;
            background: rgba(15,118,110,0.15);
            border: 1px solid rgba(45,212,191,0.4);
            color: #a5f3fc;
            text-transform: uppercase;
        }

        .table-wrapper {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            margin-top: 4px;
        }

        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }

        thead { background: linear-gradient(to right, rgba(56,189,248,0.12), rgba(129,140,248,0.12)); }

        th, td { padding: 6px 7px; text-align: left; white-space: nowrap; }

        th {
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.09em;
            color: #9ca3af;
            border-bottom: 1px solid rgba(148,163,184,0.35);
        }

        tbody tr:nth-child(odd) { background: rgba(15,23,42,0.9); }
        tbody tr:nth-child(even) { background: rgba(15,23,42,0.75); }
        tbody tr td:first-child { color: #6b7280; font-size: 0.8rem; }

        .team-name { font-weight: 500; color: #e5e7eb; }

        .tag {
            font-size: 0.78rem;
            padding: 2px 7px;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.4);
        }

        .tag.div { border-color: rgba(56,189,248,0.6); color: #7dd3fc; }
        .tag.wild { border-color: rgba(52,211,153,0.7); color: #6ee7b7; }
        .tag.out { border-color: rgba(148,163,184,0.5); color: #9ca3af; }

        .side-stack { display: grid; grid-template-rows: auto auto; gap: 14px; }

        .tiebreak-list { font-size: 0.8rem; color: #d1d5db; margin-left: 14px; margin-top: 6px; line-height: 1.45; }
        .tiebreak-list li { margin-bottom: 4px; }

        details.tiebreaker-details {
            margin-top: 10px;
            padding: 10px 12px;
            border-radius: 12px;
            background: rgba(15,23,42,0.8);
            border: 1px solid rgba(148,163,184,0.5);
        }

        details.tiebreaker-details summary {
            cursor: pointer;
            list-style: none;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.13em;
            color: #e5e7eb;
        }

        details.tiebreaker-details summary::marker { display: none; }
        details.tiebreaker-details summary::-webkit-details-marker { display: none; }

        .note { font-size: 0.78rem; color: #9ca3af; margin-top: 10px; line-height: 1.4; }

        .h2h-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 6px 0 8px;
        }

        select, button {
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.7);
            background: rgba(15,23,42,0.9);
            color: #e5e7eb;
            font-size: 0.82rem;
            padding: 5px 10px;
        }

        button {
            cursor: pointer;
            border-color: #38bdf8;
            background: linear-gradient(135deg, #0ea5e9, #22c55e);
            color: #0f172a;
            font-weight: 600;
        }

        button:hover { filter: brightness(1.05); }

        #h2h-result { font-size: 0.82rem; color: #e5e7eb; min-height: 18px; margin-top: 4px; }

        #h2h-note { font-size: 0.75rem; color: #9ca3af; margin-top: 6px; line-height: 1.35; }

        .bracket-svg-wrapper {
            margin-top: 10px;
            border-radius: 14px;
            border: 1px solid rgba(148,163,184,0.35);
            background: radial-gradient(circle at top, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
            padding: 8px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .bracket-svg { width: 100%; height: auto; min-width: 480px; display: block; }

        @media (max-width: 900px) {
            .grid { grid-template-columns: 1fr; }
            header {
                flex-direction: column;
                align-items: flex-start;
                gap: 6px;
            }
        }

        @media (max-width: 600px) {
            body {
                padding: 20px 8px 24px;
            }

            header h1 {
                font-size: 1.4rem;
            }

            header .subtitle {
                font-size: 0.85rem;
            }

            .card {
                padding: 14px 12px 14px;
            }

            th, td {
                padding: 5px 5px;
                font-size: 0.8rem;
            }

            .h2h-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .h2h-controls select,
            .h2h-controls button {
                width: 100%;
            }

            .badge {
                font-size: 0.75rem;
                padding: 5px 10px;
            }
        }
    </style>
</head>
<body>
<div class="page">
    <header>
        <div>
            <h1>Fantasy League – Projected Standings</h1>
            <div class="subtitle">
                Based on current results through Week 11. Top 3 seeds receive a first-round bye.
            </div>
        </div>
        <span class="badge">Live Snapshot</span>
    </header>

    <div class="grid">
        <!-- LEFT: STANDINGS -->
        <div class="card">
            <div class="card-header">
                <h2>League Table</h2>
                <span class="pill">Seeds · PF · PA · Playoff %</span>
            </div>

            <div class="table-wrapper">
                <table>
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>Team</th>
                        <th>Seed</th>
                        <th>Div</th>
                        <th>Record</th>
                        <th>PF</th>
                        <th>PA</th>
                        <th>PO%</th>
                        <th>Status</th>
                    </tr>
                    </thead>
                    <tbody id="standings-body"></tbody>
                </table>
            </div>

            <!-- COLLAPSIBLE TIE-BREAKER SUMMARY -->
            <details class="tiebreaker-details">
                <summary> Tie-breaker & Seeding Notes (click) </summary>
                <ul class="tiebreak-list">
                    <li><strong>Division winners</strong> auto-lock top 2 seeds:
                        <em>James Teams Sucks</em> (Fish division) and <em>Crip Crip</em> (Crabs division),
                        both at 7–4. James holds the #1 seed via tiebreak (head-to-head + current ESPN ordering).
                    </li>
                    <li><strong>Dart Party</strong> (7–4) is the best non-division-winner and takes
                        the #3 seed. Under your updated rule, seeds <strong>#1–#3 all get a first-round bye</strong>.
                    </li>
                    <li><strong>Duloc InjuredBread Men- 12</strong> and <strong>HerpesDonator</strong> (both 6–5)
                        fill seeds #4 and #5. Duloc is ahead of Herpes because the ESPN standings already have Duloc higher
                        inside that tied record group (your league’s head-to-head/secondary tiebreakers).
                    </li>
                    <li><strong>Our Lard and Savior</strong>, <strong>Josh's Scary Team</strong>, and
                        <strong>Indoctrinated Ravens</strong> are all 5–6. They’re still mathematically alive,
                        but currently outside the 5-team playoff cut and chasing the 6–5/7–4 group.</li>
                    <li><strong>Koolaid Jammer</strong> (4–7) and <strong>Don't Blink</strong> (3–8) need
                        near-perfect finishes plus help. Their playoff odds are very low but not literally zero yet.</li>
                </ul>
                <p class="note">
                    Playoff % values are a rough projection based on current record, remaining schedule, and the ESPN
                    probabilities you see on the site: strong locks in the 90s, bubble teams in the 30–60 range, and
                    longshots under 10%.
                </p>
            </details>
        </div>

        <!-- RIGHT: BRACKET + H2H -->
        <div class="side-stack">
            <!-- BRACKET CARD -->
            <div class="card">
                <div class="card-header">
                    <h2>Projected Playoff Bracket</h2>
                    <span class="pill">Top 3 = First-Round Bye</span>
                </div>

                <div class="bracket-svg-wrapper">
                    <svg viewBox="0 0 640 260" class="bracket-svg">
                        <!-- Wildcard (4 vs 5) -->
                        <line x1="20" y1="50" x2="180" y2="50" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="20" y1="90" x2="180" y2="90" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="180" y1="50" x2="180" y2="90" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="180" y1="70" x2="280" y2="70" stroke="#38bdf8" stroke-width="2"/>

                        <!-- Semi A: #1 vs Winner 4/5 -->
                        <line x1="280" y1="70" x2="280" y2="120" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="280" y1="120" x2="390" y2="120" stroke="#38bdf8" stroke-width="2"/>

                        <!-- Semi B: #2 vs #3 (both had byes) -->
                        <line x1="20" y1="170" x2="180" y2="170" stroke="#22c55e" stroke-width="2"/>
                        <line x1="20" y1="210" x2="180" y2="210" stroke="#22c55e" stroke-width="2"/>
                        <line x1="180" y1="170" x2="180" y2="210" stroke="#22c55e" stroke-width="2"/>
                        <line x1="180" y1="190" x2="280" y2="190" stroke="#22c55e" stroke-width="2"/>
                        <line x1="280" y1="190" x2="390" y2="190" stroke="#22c55e" stroke-width="2"/>

                        <!-- Championship -->
                        <line x1="390" y1="120" x2="390" y2="190" stroke="#facc15" stroke-width="2"/>
                        <line x1="390" y1="155" x2="580" y2="155" stroke="#facc15" stroke-width="3"/>

                        <!-- Labels: Wildcard -->
                        <text x="24" y="42" fill="#e5e7eb" font-size="11">(4) Duloc InjuredBread Men- 12</text>
                        <text x="24" y="82" fill="#e5e7eb" font-size="11">(5) HerpesDonator</text>
                        <text x="188" y="66" fill="#9ca3af" font-size="10">Winner 4 vs 5</text>

                        <!-- Labels: Semi A -->
                        <text x="288" y="110" fill="#e5e7eb" font-size="11">Semi A:</text>
                        <text x="288" y="125" fill="#e5e7eb" font-size="11">
                            (1) James Teams Sucks vs Winner 4/5
                        </text>
                        <text x="288" y="140" fill="#9ca3af" font-size="9">
                            #1 seed had first-round bye
                        </text>

                        <!-- Labels: Semi B -->
                        <text x="24" y="162" fill="#e5e7eb" font-size="11">(2) Crip Crip</text>
                        <text x="24" y="202" fill="#e5e7eb" font-size="11">(3) Dart Party</text>
                        <text x="188" y="186" fill="#e5e7eb" font-size="11">Semi B: (2) vs (3)</text>
                        <text x="188" y="201" fill="#9ca3af" font-size="9">
                            both were byes in Round 1
                        </text>

                        <!-- Labels: Championship -->
                        <text x="486" y="149" fill="#facc15" font-size="12" font-weight="bold">Championship</text>
                        <text x="486" y="167" fill="#e5e7eb" font-size="11">
                            Highest remaining vs lowest remaining
                        </text>
                    </svg>
                </div>

                <p class="note">
                    Round 1: only <strong>(4) Duloc</strong> vs <strong>(5) HerpesDonator</strong> play.  
                    Round 2 (semis): you <strong>reseed</strong> – the <strong>lowest remaining seed</strong>
                    faces the <strong>highest remaining seed</strong>. In this 5-team setup, that always becomes:<br>
                    • Semi A: <strong>#1 James Teams Sucks</strong> vs Winner of <strong>#4/#5</strong><br>
                    • Semi B: <strong>#2 Crip Crip</strong> vs <strong>#3 Dart Party</strong><br>
                    Winners meet in the title game.
                </p>
            </div>

            <!-- H2H CARD -->
            <div class="card">
                <div class="card-header">
                    <h2>Head-to-Head Lookup</h2>
                    <span class="pill">From schedule.json</span>
                </div>
                <p style="font-size:0.84rem;color:#d1d5db;margin-bottom:4px;">
                    Select two teams to see their head-to-head record based on all completed games.
                </p>
                <div class="h2h-controls">
                    <select id="teamA"></select>
                    <span style="align-self:center;font-size:0.8rem;color:#9ca3af;">vs</span>
                    <select id="teamB"></select>
                    <button type="button" onclick="showHeadToHead()">Show H2H</button>
                </div>
                <div id="h2h-result"></div>
                <div id="h2h-note">
                    This reads from <code>schedule.json</code> in the same folder. Games with <code>null</code>
                    scores (weeks not played yet) are ignored.
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // PROJECTED STANDINGS AFTER WEEK 11
    // Divisions: Crabs = 1, Fish = 2
    const teams = [
        {
            rank: 1,
            seed: 1,
            name: "James Teams Sucks",
            division: 2,
            record: "7–4",
            pf: 1748.75,
            pa: 1583.20,
            playoffChance: 96,
            status: "Fish Champ · #1 Seed · First-Round Bye",
            tagType: "div"
        },
        {
            rank: 2,
            seed: 2,
            name: "Crip Crip",
            division: 1,
            record: "7–4",
            pf: 1808.50,
            pa: 1619.15,
            playoffChance: 97,
            status: "Crabs Champ · #2 Seed · First-Round Bye",
            tagType: "div"
        },
        {
            rank: 3,
            seed: 3,
            name: "Dart Party",
            division: 1,
            record: "7–4",
            pf: 1655.75,
            pa: 1655.40,
            playoffChance: 92,
            status: "#3 Seed · First-Round Bye",
            tagType: "wild"
        },
        {
            rank: 4,
            seed: 4,
            name: "Duloc InjuredBread Men- 12",
            division: 1,
            record: "6–5",
            pf: 1612.50,
            pa: 1643.00,
            playoffChance: 55,
            status: "#4 Seed · Wildcard Game",
            tagType: "wild"
        },
        {
            rank: 5,
            seed: 5,
            name: "HerpesDonator",
            division: 2,
            record: "6–5",
            pf: 1758.00,
            pa: 1669.10,
            playoffChance: 67,
            status: "#5 Seed · Wildcard Game",
            tagType: "wild"
        },
        {
            rank: 6,
            seed: "-",
            name: "Our Lard and Savior",
            division: 1,
            record: "5–6",
            pf: 1749.00,
            pa: 1690.85,
            playoffChance: 41,
            status: "Bubble – Needs wins + help",
            tagType: "out"
        },
        {
            rank: 7,
            seed: "-",
            name: "Josh's Scary Team",
            division: 1,
            record: "5–6",
            pf: 1682.15,
            pa: 1733.65,
            playoffChance: 33,
            status: "Bubble – Needs wins + help",
            tagType: "out"
        },
        {
            rank: 8,
            seed: "-",
            name: "Indoctrinated Ravens",
            division: 2,
            record: "5–6",
            pf: 1577.40,
            pa: 1685.80,
            playoffChance: 11,
            status: "Outside looking in",
            tagType: "out"
        },
        {
            rank: 9,
            seed: "-",
            name: "Koolaid Jammer",
            division: 2,
            record: "4–7",
            pf: 1603.80,
            pa: 1682.50,
            playoffChance: 8,
            status: "Longshot",
            tagType: "out"
        },
        {
            rank: 10,
            seed: "-",
            name: "Don't Blink",
            division: 2,
            record: "3–8",
            pf: 1476.10,
            pa: 1709.30,
            playoffChance: 1,
            status: "Needs miracle run",
            tagType: "out"
        }
    ];

    let scheduleData = [];

    async function loadSchedule() {
        try {
            const res = await fetch('schedule.json');
            if (!res.ok) throw new Error('HTTP ' + res.status);
            scheduleData = await res.json();
        } catch (err) {
            console.error('Error loading schedule.json:', err);
            const el = document.getElementById('h2h-result');
            if (el) {
                el.textContent = 'Could not load schedule.json – check that it exists next to this HTML file.';
            }
        }
    }

    function renderStandings() {
        const tbody = document.getElementById("standings-body");
        tbody.innerHTML = "";
        teams.forEach(team => {
            const tr = document.createElement("tr");

            const cells = [
                team.rank,
                team.name,
                team.seed,
                team.division,
                team.record,
                team.pf.toFixed(2),
                team.pa.toFixed(2),
                team.playoffChance + "%"
            ];

            cells.forEach((val, idx) => {
                const td = document.createElement("td");
                td.textContent = val;
                if (idx === 1) td.className = "team-name";
                tr.appendChild(td);
            });

            const statusTd = document.createElement("td");
            const span = document.createElement("span");
            span.className = "tag " + team.tagType;
            span.textContent = team.status;
            statusTd.appendChild(span);
            tr.appendChild(statusTd);

            tbody.appendChild(tr);
        });
    }

    function populateDropdowns() {
        const selectA = document.getElementById("teamA");
        const selectB = document.getElementById("teamB");
        teams.forEach(t => {
            const optA = document.createElement("option");
            optA.value = t.name;
            optA.textContent = t.name;
            selectA.appendChild(optA);

            const optB = document.createElement("option");
            optB.value = t.name;
            optB.textContent = t.name;
            selectB.appendChild(optB);
        });

        if (teams.length >= 2) {
            selectA.value = "Crip Crip";
            selectB.value = "Dart Party";
        }
    }

    function showHeadToHead() {
        const teamA = document.getElementById("teamA").value;
        const teamB = document.getElementById("teamB").value;
        const resultDiv = document.getElementById("h2h-result");

        if (!scheduleData || scheduleData.length === 0) {
            resultDiv.textContent = "Schedule data not loaded yet. Make sure schedule.json exists and reload.";
            return;
        }

        if (teamA === teamB) {
            resultDiv.textContent = "Pick two different teams to see a matchup.";
            return;
        }

        const games = scheduleData.filter(g => {
            const involves =
                (g.home === teamA && g.away === teamB) ||
                (g.home === teamB && g.away === teamA);
            const finished = g.homeScore !== null && g.awayScore !== null;
            return involves && finished;
        });

        if (games.length === 0) {
            resultDiv.textContent = `${teamA} and ${teamB} have no completed games in schedule.json.`;
            return;
        }

        let aWins = 0, aLosses = 0, aTies = 0;
        const breakdown = [];

        games.forEach(g => {
            const aIsHome = g.home === teamA;
            const aScore = aIsHome ? g.homeScore : g.awayScore;
            const bScore = aIsHome ? g.awayScore : g.homeScore;

            let outcome;
            if (aScore > bScore) {
                aWins++;
                outcome = `${teamA} W`;
            } else if (aScore < bScore) {
                aLosses++;
                outcome = `${teamA} L`;
            } else {
                aTies++;
                outcome = "T";
            }

            breakdown.push(
                `Week ${g.week}: ${g.away} ${g.awayScore.toFixed(2)} @ ${g.home} ${g.homeScore.toFixed(2)} – ${outcome}`
            );
        });

        const recordStr = `${teamA} vs ${teamB}: ${aWins}-${aLosses}` + (aTies ? `-${aTies}` : "");
        resultDiv.innerHTML = recordStr + "<br>" + breakdown.join("<br>");
    }

    document.addEventListener('DOMContentLoaded', () => {
        renderStandings();
        populateDropdowns();
        loadSchedule();
    });
</script>
</body>
</html>
