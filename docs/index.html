<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fantasy League – Projected Standings & Playoffs</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top left, #0f172a 0, #020617 45%, #000 100%);
            color: #e5e7eb;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 32px 16px 40px;
        }

        .page { width: 100%; max-width: 1200px; }

        header {
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            gap: 16px;
            align-items: center;
        }

        header h1 { font-size: 1.9rem; letter-spacing: 0.03em; }

        header .subtitle { font-size: 0.95rem; color: #9ca3af; margin-top: 4px; }

        .badge {
            font-size: 0.85rem;
            padding: 6px 14px;
            border-radius: 999px;
            background: linear-gradient(135deg, #22c55e, #38bdf8);
            color: #0f172a;
            font-weight: 600;
            text-transform: uppercase;
            white-space: nowrap;
        }

        .grid {
            display: grid;
            grid-template-columns: minmax(0, 1.2fr) minmax(0, 1fr);
            gap: 20px;
        }

        .card {
            background: linear-gradient(145deg, rgba(15,23,42,0.98), rgba(15,23,42,0.85));
            border-radius: 18px;
            border: 1px solid rgba(148,163,184,0.25);
            box-shadow: 0 18px 40px rgba(15,23,42,0.7);
            padding: 18px 20px 18px;
            backdrop-filter: blur(14px);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: baseline;
            margin-bottom: 10px;
        }

        .card-header h2 { font-size: 1.15rem; letter-spacing: 0.06em; text-transform: uppercase; }

        .pill {
            font-size: 0.75rem;
            padding: 3px 9px;
            border-radius: 999px;
            background: rgba(15,118,110,0.15);
            border: 1px solid rgba(45,212,191,0.4);
            color: #a5f3fc;
            text-transform: uppercase;
        }

        table { width: 100%; border-collapse: collapse; font-size: 0.9rem; margin-top: 4px; }

        thead { background: linear-gradient(to right, rgba(56,189,248,0.12), rgba(129,140,248,0.12)); }

        th, td { padding: 6px 7px; text-align: left; white-space: nowrap; }

        th {
            font-size: 0.78rem;
            text-transform: uppercase;
            letter-spacing: 0.09em;
            color: #9ca3af;
            border-bottom: 1px solid rgba(148,163,184,0.35);
        }

        tbody tr:nth-child(odd) { background: rgba(15,23,42,0.9); }
        tbody tr:nth-child(even) { background: rgba(15,23,42,0.75); }
        tbody tr td:first-child { color: #6b7280; font-size: 0.8rem; }

        .team-name { font-weight: 500; color: #e5e7eb; }

        .tag {
            font-size: 0.78rem;
            padding: 2px 7px;
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.4);
        }

        .tag.div { border-color: rgba(56,189,248,0.6); color: #7dd3fc; }
        .tag.wild { border-color: rgba(52,211,153,0.7); color: #6ee7b7; }
        .tag.out { border-color: rgba(148,163,184,0.5); color: #9ca3af; }

        .section-title {
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.13em;
            color: #9ca3af;
            margin-bottom: 6px;
            margin-top: 12px;
        }

        .note { font-size: 0.78rem; color: #9ca3af; margin-top: 10px; line-height: 1.4; }

        .side-stack { display: grid; grid-template-rows: auto auto; gap: 14px; }

        .tiebreak-list { font-size: 0.8rem; color: #d1d5db; margin-left: 14px; margin-top: 6px; line-height: 1.45; }
        .tiebreak-list li { margin-bottom: 4px; }

        details.tiebreaker-details {
            margin-top: 10px;
            padding: 10px 12px;
            border-radius: 12px;
            background: rgba(15,23,42,0.8);
            border: 1px solid rgba(148,163,184,0.5);
        }

        details.tiebreaker-details summary {
            cursor: pointer;
            list-style: none;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.13em;
            color: #e5e7eb;
        }

        details.tiebreaker-details summary::marker { display: none; }
        details.tiebreaker-details summary::-webkit-details-marker { display: none; }

        .h2h-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 6px 0 8px;
        }

        select, button {
            border-radius: 999px;
            border: 1px solid rgba(148,163,184,0.7);
            background: rgba(15,23,42,0.9);
            color: #e5e7eb;
            font-size: 0.82rem;
            padding: 5px 10px;
        }

        button {
            cursor: pointer;
            border-color: #38bdf8;
            background: linear-gradient(135deg, #0ea5e9, #22c55e);
            color: #0f172a;
            font-weight: 600;
        }

        button:hover { filter: brightness(1.05); }

        #h2h-result { font-size: 0.82rem; color: #e5e7eb; min-height: 18px; margin-top: 4px; }

        #h2h-note { font-size: 0.75rem; color: #9ca3af; margin-top: 6px; line-height: 1.35; }

        .bracket-svg-wrapper {
            margin-top: 10px;
            border-radius: 14px;
            border: 1px solid rgba(148,163,184,0.35);
            background: radial-gradient(circle at top, rgba(15,23,42,0.98), rgba(15,23,42,0.9));
            padding: 8px;
        }

        .bracket-svg { width: 100%; height: auto; display: block; }

        @media (max-width: 900px) {
            .grid { grid-template-columns: 1fr; }
            header { flex-direction: column; align-items: flex-start; gap: 4px; }
        }
    </style>
</head>
<body>
<div class="page">
    <header>
        <div>
            <h1>Fantasy League – Projected Week Standings</h1>
            <div class="subtitle">If all current projections hold for this week.</div>
        </div>
        <span class="badge">Projected After This Week</span>
    </header>

    <div class="grid">
        <!-- LEFT: STANDINGS -->
        <div class="card">
            <div class="card-header">
                <h2>Projected League Table</h2>
                <span class="pill">Seeds · PF · PA</span>
            </div>
            <table>
                <thead>
                <tr>
                    <th>#</th>
                    <th>Team</th>
                    <th>Seed</th>
                    <th>Div</th>
                    <th>Record</th>
                    <th>PF</th>
                    <th>PA</th>
                    <th>Status</th>
                </tr>
                </thead>
                <tbody id="standings-body"></tbody>
            </table>

            <!-- COLLAPSIBLE TIE-BREAKER SUMMARY -->
            <details class="tiebreaker-details">
                <summary> Tie-breaker Summary (click to expand) </summary>
                <ul class="tiebreak-list">
                    <li><strong>Division winners</strong> take the top two seeds:
                        <em>James Teams Sucks</em> (Div 2 champ) and <em>Dart Party</em> (Div 1 champ). Both finish 7–4.
                    </li>
                    <li><strong>Crip Crip</strong> is also 7–4, but not a division winner, so they become the top wildcard at seed #3.</li>
                    <li><strong>HerpesDonator</strong> and <strong>Duloc InjuredBread Men- 12</strong> both finish 6–5.
                        HerpesDonator is projected above Duloc because they are ahead in the ESPN standings
                        (your league uses head-to-head as the actual tiebreaker).
                    </li>
                    <li><strong>Our Lard and Savior</strong>, <strong>Josh's Scary Team</strong>, and
                        <strong>Indoctrinated Ravens</strong> all land at 5–6 and miss the cut.
                        Their internal order follows the current site ranking, which again is based on your league's
                        head-to-head/secondary rules.
                    </li>
                </ul>
                <p class="note">
                    Real tiebreakers in your league are head-to-head, then whatever secondary rules your settings use.
                    This page keeps the same ordering ESPN currently shows inside each tied record group and simply
                    applies your “top team in each division, then next 3 best records” playoff rule.
                </p>
            </details>
        </div>

        <!-- RIGHT: BRACKET + H2H -->
        <div class="side-stack">
            <!-- BRACKET CARD -->
            <div class="card">
                <div class="card-header">
                    <h2>Projected 5-Team Playoff Bracket</h2>
                    <span class="pill">Bracket Style</span>
                </div>

                <div class="bracket-svg-wrapper">
                    <svg viewBox="0 0 620 240" class="bracket-svg">
                        <!-- Lines -->
                        <line x1="20" y1="40" x2="150" y2="40" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="20" y1="80" x2="150" y2="80" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="150" y1="40" x2="150" y2="80" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="150" y1="60" x2="260" y2="60" stroke="#38bdf8" stroke-width="2"/>

                        <line x1="260" y1="60" x2="260" y2="100" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="260" y1="100" x2="380" y2="100" stroke="#38bdf8" stroke-width="2"/>

                        <line x1="20" y1="160" x2="150" y2="160" stroke="#22c55e" stroke-width="2"/>
                        <line x1="20" y1="200" x2="150" y2="200" stroke="#22c55e" stroke-width="2"/>
                        <line x1="150" y1="160" x2="150" y2="200" stroke="#22c55e" stroke-width="2"/>
                        <line x1="150" y1="180" x2="260" y2="180" stroke="#22c55e" stroke-width="2"/>

                        <line x1="260" y1="180" x2="260" y2="140" stroke="#38bdf8" stroke-width="2"/>
                        <line x1="260" y1="140" x2="480" y2="140" stroke="#facc15" stroke-width="2"/>

                        <line x1="380" y1="100" x2="380" y2="140" stroke="#facc15" stroke-width="2"/>

                        <line x1="480" y1="140" x2="580" y2="140" stroke="#facc15" stroke-width="3"/>

                        <!-- Labels -->
                        <text x="24" y="32" fill="#e5e7eb" font-size="11">(4) HerpesDonator</text>
                        <text x="24" y="72" fill="#e5e7eb" font-size="11">(5) Duloc InjuredBread Men- 12</text>
                        <text x="160" y="55" fill="#9ca3af" font-size="10">Winner Match A</text>

                        <text x="268" y="96" fill="#e5e7eb" font-size="11">vs (1) James Teams Sucks</text>

                        <text x="24" y="152" fill="#e5e7eb" font-size="11">(2) Dart Party</text>
                        <text x="24" y="192" fill="#e5e7eb" font-size="11">(3) Crip Crip</text>
                        <text x="160" y="175" fill="#9ca3af" font-size="10">Winner Match B</text>

                        <text x="486" y="134" fill="#facc15" font-size="12" font-weight="bold">Championship</text>
                        <text x="486" y="152" fill="#e5e7eb" font-size="11">
                            Winner Semi 1 vs Winner Match B
                        </text>
                    </svg>
                </div>

                <p class="note">
                    Top fork: (4) HerpesDonator vs (5) Duloc InjuredBread Men- 12 → winner plays (1) James Teams Sucks.  
                    Bottom fork: (2) Dart Party vs (3) Crip Crip → winner goes straight to the final.
                </p>
            </div>

            <!-- H2H CARD -->
            <div class="card">
                <div class="card-header">
                    <h2>Head-to-Head Lookup</h2>
                    <span class="pill">Interactive</span>
                </div>
                <p style="font-size:0.84rem;color:#d1d5db;margin-bottom:4px;">
                    Uses <code>schedule.json</code> to calculate records automatically.
                </p>
                <div class="h2h-controls">
                    <select id="teamA"></select>
                    <span style="align-self:center;font-size:0.8rem;color:#9ca3af;">vs</span>
                    <select id="teamB"></select>
                    <button type="button" onclick="showHeadToHead()">Show H2H</button>
                </div>
                <div id="h2h-result"></div>
                <div id="h2h-note">
                    Make sure <code>schedule.json</code> is in the same folder as this HTML in your GitHub
                    <code>/docs</code> directory. The lookup ignores games that don't have scores yet.
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // PROJECTED STANDINGS FOR AFTER THIS WEEK (same as before)
    const teams = [
        { rank: 1, seed: 1, name: "James Teams Sucks", division: 2, record: "7–4", pf: 1618.2, pa: 1433.0,
          status: "Division 2 Champ · #1 Seed", tagType: "div" },
        { rank: 2, seed: 2, name: "Dart Party", division: 1, record: "7–4", pf: 1514.35, pa: 1486.35,
          status: "Division 1 Champ · #2 Seed", tagType: "div" },
        { rank: 3, seed: 3, name: "Crip Crip", division: 1, record: "7–4", pf: 1626.45, pa: 1491.05,
          status: "Top Wildcard · #3 Seed", tagType: "wild" },
        { rank: 4, seed: 4, name: "HerpesDonator", division: 2, record: "6–5", pf: 1607.8, pa: 1538.55,
          status: "Wildcard · #4 Seed", tagType: "wild" },
        { rank: 5, seed: 5, name: "Duloc InjuredBread Men- 12", division: 1, record: "6–5", pf: 1443.45, pa: 1501.6,
          status: "Wildcard · #5 Seed", tagType: "wild" },
        { rank: 6, seed: "-", name: "Our Lard and Savior", division: 1, record: "5–6", pf: 1620.9, pa: 1508.8,
          status: "Outside Playoffs", tagType: "out" },
        { rank: 7, seed: "-", name: "Josh's Scary Team", division: 1, record: "5–6", pf: 1572.0, pa: 1594.2,
          status: "Outside Playoffs", tagType: "out" },
        { rank: 8, seed: "-", name: "Indoctrinated Ravens", division: 2, record: "5–6", pf: 1425.85, pa: 1537.55,
          status: "Outside Playoffs", tagType: "out" },
        { rank: 9, seed: "-", name: "Koolaid Jammer", division: 2, record: "4–7", pf: 1455.55, pa: 1530.95,
          status: "Outside Playoffs", tagType: "out" },
        { rank: 10, seed: "-", name: "Don't Blink", division: 2, record: "3–8", pf: 1336.65, pa: 1599.15,
          status: "Outside Playoffs", tagType: "out" }
    ];

    let scheduleData = [];

    async function loadSchedule() {
        try {
            const res = await fetch('schedule.json');
            if (!res.ok) throw new Error('HTTP ' + res.status);
            scheduleData = await res.json();
        } catch (err) {
            console.error('Error loading schedule.json:', err);
            const el = document.getElementById('h2h-result');
            el.textContent = 'Could not load schedule.json – check that it exists in the same folder.';
        }
    }

    function renderStandings() {
        const tbody = document.getElementById("standings-body");
        tbody.innerHTML = "";
        teams.forEach(team => {
            const tr = document.createElement("tr");

            const cells = [
                team.rank,
                team.name,
                team.seed,
                team.division,
                team.record,
                team.pf.toFixed(2),
                team.pa.toFixed(2)
            ];

            cells.forEach((val, idx) => {
                const td = document.createElement("td");
                td.textContent = val;
                if (idx === 1) td.className = "team-name";
                tr.appendChild(td);
            });

            const statusTd = document.createElement("td");
            const span = document.createElement("span");
            span.className = "tag " + team.tagType;
            span.textContent = team.status;
            statusTd.appendChild(span);
            tr.appendChild(statusTd);

            tbody.appendChild(tr);
        });
    }

    function populateDropdowns() {
        const selectA = document.getElementById("teamA");
        const selectB = document.getElementById("teamB");
        teams.forEach(t => {
            const optA = document.createElement("option");
            optA.value = t.name;
            optA.textContent = t.name;
            selectA.appendChild(optA);

            const optB = document.createElement("option");
            optB.value = t.name;
            optB.textContent = t.name;
            selectB.appendChild(optB);
        });

        if (teams.length >= 2) {
            selectA.value = teams[2].name; // Crip Crip
            selectB.value = teams[1].name; // Dart Party
        }
    }

    function canonicalKey(a, b) {
        return a < b ? `${a}|${b}` : `${b}|${a}`;
    }

    function showHeadToHead() {
        const teamA = document.getElementById("teamA").value;
        const teamB = document.getElementById("teamB").value;
        const resultDiv = document.getElementById("h2h-result");

        if (!scheduleData || scheduleData.length === 0) {
            resultDiv.textContent = "Schedule data not loaded yet. Make sure schedule.json exists and reload.";
            return;
        }

        if (teamA === teamB) {
            resultDiv.textContent = "Pick two different teams to see a matchup.";
            return;
        }

        const games = scheduleData.filter(g => {
            const involves = (g.home === teamA && g.away === teamB) || (g.home === teamB && g.away === teamA);
            const finished = g.homeScore !== null && g.awayScore !== null;
            return involves && finished;
        });

        if (games.length === 0) {
            resultDiv.textContent = `${teamA} and ${teamB} have no completed games in schedule.json.`;
            return;
        }

        let aWins = 0, aLosses = 0, aTies = 0;
        const breakdown = [];

        games.forEach(g => {
            const aScore = (g.home === teamA) ? g.homeScore : g.awayScore;
            const bScore = (g.home === teamB) ? g.homeScore : g.awayScore;

            let outcome;
            if (aScore > bScore) { aWins++; outcome = `${teamA} W`; }
            else if (aScore < bScore) { aLosses++; outcome = `${teamA} L`; }
            else { aTies++; outcome = "T"; }

            breakdown.push(
                `Week ${g.week}: ${g.away} ${g.awayScore.toFixed(2)} @ ${g.home} ${g.homeScore.toFixed(2)} – ${outcome}`
            );
        });

        const recordStr = `${teamA} vs ${teamB}: ${aWins}-${aLosses}` + (aTies ? `-${aTies}` : "");
        resultDiv.innerHTML = recordStr + "<br>" + breakdown.join("<br>");
    }

    document.addEventListener('DOMContentLoaded', () => {
        renderStandings();
        populateDropdowns();
        loadSchedule();
    });
</script>
</body>
</html>
